<base:UserControlBase
    x:Class="NarakaBladepoint.Modules.CommonFunction.UI.CustomMatch.Views.CustomMatchPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:b="clr-namespace:Microsoft.Xaml.Behaviors;assembly=Microsoft.Xaml.Behaviors"
    xmlns:base="clr-namespace:NarakaBladepoint.Framework.Core.Bases.Views;assembly=NarakaBladepoint.Framework"
    xmlns:controls="clr-namespace:NarakaBladepoint.Controls;assembly=NarakaBladepoint.Controls"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:local="clr-namespace:NarakaBladepoint.Modules.CommonFunction.UI.CustomMatch.Views"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:viewmodels1="clr-namespace:NarakaBladepoint.Modules.CommonFunction.UI.CustomMatch.ViewModels"
    d:DataContext="{d:DesignInstance Type=viewmodels1:CustomMatchPageViewModel}"
    d:DesignHeight="720"
    d:DesignWidth="1280"
    mc:Ignorable="d">
    <Grid Background="{StaticResource Background2}">
        <Grid Margin="20,0,210,0">
            <Grid.RowDefinitions>
                <RowDefinition Height="80" />
                <RowDefinition Height="*" />
                <RowDefinition Height="120" />
            </Grid.RowDefinitions>

            <!--  Header with title and search  -->
            <Grid Grid.Row="0" Margin="8,15,8,0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>

                <!--  Title  -->
                <StackPanel
                    Margin="0,0,0,5"
                    VerticalAlignment="Bottom"
                    Orientation="Horizontal">
                    <TextBlock
                        FontSize="20"
                        Foreground="White"
                        Text="房间列表" />
                    <Image
                        Width="30"
                        Margin="10,0,0,0"
                        Source="{StaticResource CustomMatchRefreshImage}"
                        Stretch="Uniform">
                        <b:Interaction.Triggers>
                            <b:EventTrigger EventName="MouseLeftButtonDown">
                                <b:InvokeCommandAction Command="{Binding RefreshCommand}" />
                            </b:EventTrigger>
                        </b:Interaction.Triggers>
                    </Image>
                </StackPanel>

                <!--  Search Box  -->
                <Border
                    Grid.Column="2"
                    Width="250"
                    Height="35"
                    Margin="0,0,0,5"
                    VerticalAlignment="Bottom"
                    BorderBrush="White">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition />
                            <ColumnDefinition Width="36" />
                        </Grid.ColumnDefinitions>
                        <controls:PlaceholderTextBox
                            Name="searchbar"
                            Grid.Column="0"
                            Height="25"
                            VerticalContentAlignment="Center"
                            Background="Transparent"
                            Foreground="White"
                            Placeholder="请输入房间名称"
                            PlaceholderForeground="Gray"
                            PlaceholderMargin="10,0,0,0" />
                        <Image
                            Grid.Column="1"
                            Height="{Binding ElementName=searchbar, Path=ActualHeight}"
                            HorizontalAlignment="Left"
                            Source="{StaticResource CustomMatchSearchImage}"
                            Stretch="Uniform">
                            <b:Interaction.Triggers>
                                <b:EventTrigger EventName="MouseLeftButtonDown">
                                    <b:InvokeCommandAction Command="{Binding SearchCommand}" CommandParameter="{Binding ElementName=searchbar, Path=Text}" />
                                </b:EventTrigger>
                            </b:Interaction.Triggers>
                        </Image>
                    </Grid>
                </Border>
            </Grid>

            <!--  DataGrid with room list  -->
            <DataGrid
                Grid.Row="1"
                Margin="8,0"
                d:ItemsSource="{d:SampleData ItemCount=10}"
                AutoGenerateColumns="False"
                ColumnHeaderHeight="40"
                ColumnHeaderStyle="{StaticResource TransparentDataGridColumnHeaderStyle}"
                IsReadOnly="True"
                ItemsSource="{Binding RoomList}"
                RowHeight="40"
                RowStyle="{StaticResource TransparentDataGridRowStyle}"
                Style="{StaticResource TransparentDataGridStyle}">
                <DataGrid.Columns>
                    <!--  状态 (Status) Column  -->
                    <DataGridTemplateColumn Width="80" Header="状态">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <TextBlock
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    d:Text="准备中"
                                    Foreground="White"
                                    Text="{Binding Status}" />
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>

                    <!--  房间名称 (Room Name) Column  -->
                    <DataGridTemplateColumn Width="*" Header="房间名称">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <Grid Margin="8,0">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>
                                    <TextBlock
                                        Grid.Column="0"
                                        VerticalAlignment="Center"
                                        d:Text="雨里躲风起的房间"
                                        Foreground="White"
                                        Text="{Binding RoomName}"
                                        TextTrimming="CharacterEllipsis" />
                                    <Image
                                        Grid.Column="1"
                                        Width="16"
                                        Margin="8,0,0,0"
                                        Source="{StaticResource CustomMatchLockImage}"
                                        Stretch="Uniform"
                                        Visibility="{Binding IsLocked, Converter={StaticResource BooleanToVisibilityConverter}}" />
                                </Grid>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>

                    <!--  延迟 (Delay) Column  -->
                    <DataGridTemplateColumn Width="80" Header="延迟">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <TextBlock
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    d:Text="48ms"
                                    Foreground="#4CAF50"
                                    Text="{Binding Delay}" />
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>

                    <!--  模式 (Mode) Column  -->
                    <DataGridTemplateColumn Width="120" Header="模式">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <TextBlock
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    d:Text="无尽试炼"
                                    Foreground="White"
                                    Text="{Binding Mode}" />
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>

                    <!--  每队人数 (Players per Team) Column  -->
                    <DataGridTemplateColumn Width="100" Header="每队人数">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <TextBlock
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    d:Text="3"
                                    Foreground="White"
                                    Text="{Binding PlayersPerTeam}" />
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>

                    <!--  参赛位(裁判位) (Team Slots) Column  -->
                    <DataGridTemplateColumn Width="120" Header="参赛位(裁判位)">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <TextBlock
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    d:Text="3/6(0/0)"
                                    Foreground="White"
                                    Text="{Binding TeamSlots}" />
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>
                </DataGrid.Columns>
            </DataGrid>

            <!--  Bottom controls  -->
            <StackPanel
                Grid.Row="2"
                Margin="8,5,0,0"
                VerticalAlignment="top"
                Orientation="Horizontal">
                <Button
                    Width="200"
                    Height="30"
                    BorderThickness="0"
                    Command="{Binding CreateRoomCommand}"
                    Content="创建房间"
                    Foreground="White"
                    Style="{StaticResource CommandButtonStyle3}" />
            </StackPanel>
        </Grid>

        <!--  Esc Back Control  -->
        <controls:EscBackControl
            Grid.Row="2"
            HorizontalAlignment="Right"
            VerticalAlignment="Bottom"
            Command="{Binding ReturnCommand}" />
    </Grid>
</base:UserControlBase>